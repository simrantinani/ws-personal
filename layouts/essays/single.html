{{ define "main" }}
<main id="main" class="essay-single-page">
  <div class="essay-container">

    <!-- Essay Header -->
<header class="essay-header">
  <h1 class="essay-title">{{ .Title }}</h1>
  {{ if eq .Section "posts" }}
  <div class="essay-metadata">
        {{ .PublishDate.Format .Site.Params.dateFormat }}
        {{ if .Site.Params.showWordCount }}
          &nbsp; <span>{{ .WordCount }} words</span>
        {{ end }}
        {{ if .Site.Params.showReadingTime }}
          &nbsp; <span>~{{ .ReadingTime }} {{ if gt .ReadingTime 1 }}mins{{ else }}min{{ end }}</span>
        {{ end }}
      </div>
    </header>

    <!-- Tags -->
    {{ if .Params.tags }}
    <div class="essay-tags">
      {{ range .Params.tags }}
        <a class="essay-tag" href='{{ "tags" | absURL }}/{{ . | urlize }}'>#{{ . }}</a>
      {{ end }}
    </div>
    {{ end }}

    <!-- Table of Contents -->
    {{ if cond (ne .Params.toc nil) .Params.toc .Site.Params.toc }}
    {{ if ne .TableOfContents "<nav id=\"TableOfContents\"></nav>" }}
    <details class="essay-toc">
      <summary><b>Table of Contents</b></summary>
      <div class="toc {{ if .Site.Params.numberedSubtitles }}numbered-subtitles{{ end }}">
        {{ .TableOfContents }}
      </div>
    </details>
    {{ end }}
    {{ end }}

    <!-- Essay Content -->
    <article class="essay-content {{ if and (.Site.Params.numberedSubtitles) (not .Params.noNumbering) }}numbered-subtitles{{ end }}">
      {{ .Content }}
    </article>

    {{ else }}
    
    <!-- Essay Content (for non-post sections) -->
    <article class="essay-content {{ if and (.Site.Params.numberedSubtitles) (not .Params.noNumbering) }}numbered-subtitles{{ end }}">
      {{ .Content }}
    </article>
    
    {{ end }}

    <!-- Sharing Buttons -->
    {{ partial "sharingbuttons.html" . }}

    <!-- Navigation -->
    <nav class="essay-navigation">
      <div class="essay-nav-links">
        {{ with .PrevInSection }}
          <a class="essay-nav-link prev" href="{{ .Permalink }}">← prev</a>
        {{ else }}
          <span class="essay-nav-link spacer"></span>
        {{ end }}
        
        {{ with .NextInSection }}
          <a class="essay-nav-link next" href="{{ .Permalink }}">next →</a>
        {{ else }}
          <span class="essay-nav-link spacer"></span>
        {{ end }}
      </div>
    </nav>

  </div>
</main>

{{ if .Page.Store.Get "hasMermaid" }}
<script type="module">
  import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
  mermaid.initialize({ startOnLoad: true });
</script>
{{ end }}

{{ end }}